metric_description,metric_query,datamodel
Validate for Non-Whitelisted Software,"| tstats count from Datamodel=Software Groupby All.software | rename All.software as software | lookup software_whitelist.csv software as software Output type | fillnull value=""N/A"" | search type=""N/A""",Software
Look at Network Connection Logs,"eventtype=network_monitoring src_ip=* dest_ip=* | stats count by src_ip, dest_ip, dest_port | rename src_ip as ""Source IP""  | rename dest_ip as ""Destination IP"" | rename dest_port as ""Port"" | lookup network_topology_lookup ip as ""Destination IP"" Output location as dest_location | lookup network_topology_lookup ip as ""Source IP"" Output location as src_location | fillnull value=""external"" src_location, dest_location | iplocation ""Destination IP""  | fillnull value=""N/A"" Country",Network_Traffic
Get the results of DNS traffic for an IP address,"| tstats values(DNS.query) as query, values(DNS.reply_code) as reply_code, count from datamodel=Network_Resolution WHERE (DNS.src=$ip$ OR DNS.dest=$ip$) groupby DNS.src, DNS.dest, DNS.record_type, DNS.answer | rename DNS.src as src, DNS.dest as dest, DNS.record_type as record_type, DNS.answer as answer |  table dest, src, query, answer, reply_code, record_type",Network_Resolution
Look for authentication attempts (success and failure),"| tstats count from datamodel=Authentication Where (Authentication.dest=""$ip$"" OR Authentication.src=""$ip$"") groupby Authentication.src, Authentication.dest, Authentication.action, Authentication.authentication_method |  rename Authentication.src as src, Authentication.dest as dest, Authentication.action as action, Authentication.authentication_method as method",Authentication
